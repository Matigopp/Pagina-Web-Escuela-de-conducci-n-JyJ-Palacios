<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Escuela de Conductores J&J Palacios SPA</title>
    <style>
        /* Variables de colores basadas en tu logo */
        :root {
            --brand-red: #f53333;
            /* Rojo del logo */
            --brand-black: #1a1a1a;
            --brand-white: #ffffff;
            --brand-gray: #f4f4f4;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            color: var(--brand-black);
            background-color: var(--brand-white);
        }

        /* HEADER */
        header {
            background-color: var(--brand-red);
            padding: 0.6rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        /* Logo clickeable que reutiliza la imagen local para evitar dependencias externas */
        .logo-link {
            display: inline-flex;
            align-items: center;
            text-decoration: none;
        }

        .logo-container {
            display: flex;
            align-items: center;
            font-weight: bold;
            font-size: 1.05rem;
            letter-spacing: 0.5px;
            gap: 10px;
            color: white;
        }

        .logo-texto {
            line-height: 1.2;
        }

        .logo-img {
            width: 52px;
            height: auto;
            border-radius: 50%;
            border: 2px solid white;
            object-fit: cover;
        }

        nav a {
            color: white;
            text-decoration: none;
            margin: 0 15px;
            font-weight: 600;
            transition: opacity 0.3s ease;
        }

        nav a:hover {
            opacity: 0.85;
        }

        .enlace-admin {
            display: none;
        }

        .enlace-admin.visible {
            display: inline;
        }

        .btn-login {
            background-color: var(--brand-black);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
            border: 2px solid white;
            transition: 0.3s;
            cursor: pointer;
        }

        .btn-login:hover {
            background-color: white;
            color: var(--brand-red);
        }

        .btn-login.oculto {
            display: none;
        }

        .btn-cerrar-sesion {
            background-color: white;
            color: var(--brand-red);
            border-color: var(--brand-black);
        }

        .btn-cerrar-sesion:hover {
            background-color: var(--brand-black);
            color: white;
        }

        body.sin-scroll {
            overflow: hidden;
        }

        .capa-modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.55);
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
            z-index: 1000;
        }

        .capa-modal.visible {
            display: flex;
        }

        .modal-acceso {
            background: white;
            border-radius: 16px;
            padding: 30px;
            width: min(100%, 420px);
            position: relative;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        }

        .cerrar-modal {
            position: absolute;
            top: 12px;
            right: 12px;
            border: none;
            background: transparent;
            font-size: 24px;
            cursor: pointer;
        }

        .modal-logo {
            display: flex;
            justify-content: center;
        }

        .modal-logo img {
            width: 70px;
            border-radius: 50%;
            border: 2px solid var(--brand-red);
        }

        .modal-encabezado {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 12px;
            margin-top: 16px;
        }

        .modal-encabezado h3 {
            margin: 0 0 6px;
        }

        .icono-info {
            background: var(--brand-red);
            color: white;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .grupo-campo {
            margin-top: 16px;
        }

        .grupo-campo label {
            font-weight: 600;
            display: block;
            margin-bottom: 8px;
        }

        .campo-input {
            display: flex;
            align-items: center;
            gap: 8px;
            background: var(--brand-gray);
            border-radius: 8px;
            padding: 10px 12px;
        }

        .campo-input input {
            border: none;
            background: transparent;
            width: 100%;
            font-size: 1rem;
        }

        .campo-input input:focus {
            outline: none;
        }

        .btn-ojo {
            border: none;
            background: transparent;
            color: var(--brand-red);
            font-weight: 600;
            cursor: pointer;
        }

        .btn-ingresar {
            width: 100%;
            margin-top: 20px;
            background: var(--brand-red);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
        }

        .mensaje-error {
            color: #c0392b;
            font-weight: 600;
            margin-top: 12px;
            display: none;
        }

        .mensaje-error.visible {
            display: block;
        }

        .hero {
            position: relative;
            color: white;
            text-align: center;
            /* Mantiene el alto necesario para ver el texto completo de las im치genes del carrusel. */
            min-height: 360px;
            padding: 0;
            overflow: hidden;
            background-color: #000;
        }

        .hero-fondos {
            position: absolute;
            inset: 0;
            z-index: 0;
        }

        .hero-fondo {
            position: absolute;
            inset: 0;
            /* La imagen ocupa todo el ancho para evitar bordes negros laterales. */
            background-size: cover, cover;
            background-position: center, center;
            background-repeat: no-repeat;
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }

        .hero-fondo.activo {
            opacity: 1;
        }

        @media (max-width: 768px) {
            .hero-fondo {
                /* Mantiene la cobertura completa en pantallas peque침as. */
                background-size: cover, cover;
            }
        }

        .hero h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 0 3px 6px rgba(0, 0, 0, 0.45);
        }

        .hero p {
            font-size: 1.2rem;
            margin-bottom: 25px;
        }

        .hero-controles {
            position: absolute;
            display: flex;
            gap: 10px;
            justify-content: center;
            align-items: center;
            bottom: 35px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 2;
        }

        .control-hero {
            width: 26px;
            height: 6px;
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.75);
            background-color: rgba(255, 255, 255, 0.25);
            cursor: pointer;
            opacity: 0.7;
            transition: background-color 0.4s ease, width 0.4s ease, opacity 0.2s ease;
        }

        .control-hero:hover {
            opacity: 1;
        }

        .control-hero.activo {
            width: 40px;
            background-color: white;
            opacity: 1;
        }

        .hero-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn-primary {
            background-color: var(--brand-red);
            color: white;
            border: none;
            padding: 12px 22px;
            font-size: 1rem;
            border-radius: 6px;
            cursor: pointer;
            text-decoration: none;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.25);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.25);
        }

        .section-container {
            padding: 60px 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        h2 {
            text-align: center;
            color: var(--brand-red);
            font-size: 2.1rem;
            margin-bottom: 40px;
            text-transform: uppercase;
        }

        .subtitulo-galeria {
            text-align: left;
            color: var(--brand-red);
            font-size: 1.6rem;
            margin: 30px 0 20px;
            text-transform: uppercase;
        }

        /* SOBRE NOSOTROS */
        .about-box {
            background-color: var(--brand-gray);
            padding: 40px;
            border-left: 5px solid var(--brand-red);
            border-radius: 8px;
            line-height: 1.6;
        }

        .galeria-examenes {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-top: 35px;
        }

        .tarjeta-imagen {
            background: white;
            border: 1px solid #e5e5e5;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.08);
            transition: transform 0.2s ease;
        }

        .tarjeta-imagen:hover {
            transform: translateY(-2px);
        }

        .tarjeta-imagen img {
            width: 100%;
            height: 220px;
            object-fit: cover;
            display: block;
            cursor: zoom-in;
            transition: transform 0.25s ease;
        }

        .tarjeta-imagen img:focus-visible {
            outline: 3px solid var(--brand-red);
            outline-offset: 4px;
        }

        .visor-imagen {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.85);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.28s ease;
            z-index: 999;
            padding: 20px;
        }

        .visor-imagen.activo {
            opacity: 1;
            pointer-events: auto;
        }

        .visor-caja {
            position: relative;
            max-width: 90vw;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            gap: 12px;
            align-items: flex-end;
        }

        .visor-caja img {
            max-width: 100%;
            max-height: 80vh;
            border-radius: 12px;
            box-shadow: 0 18px 45px rgba(0, 0, 0, 0.35);
            transform: scale(0.94);
            transition: transform 0.28s ease;
        }

        .visor-imagen.activo .visor-caja img {
            transform: scale(1);
        }

        .boton-cerrar {
            background: rgba(26, 26, 26, 0.85);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.4);
            padding: 10px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.2s ease, transform 0.15s ease;
        }

        .boton-cerrar:hover {
            background: rgba(26, 26, 26, 1);
            transform: translateY(-1px);
        }

        .boton-cerrar:focus-visible {
            outline: 3px solid var(--brand-red);
            outline-offset: 3px;
        }

        body.sin-scroll {
            overflow: hidden;
        }

        footer {
            background-color: var(--brand-black);
            color: white;
            padding: 50px 20px;
        }

        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .footer-col h3 {
            color: var(--brand-red);
            border-bottom: 1px solid gray;
            padding-bottom: 10px;
        }

        .footer-col p,
        .footer-col a {
            color: white;
            margin: 6px 0;
            text-decoration: none;
        }

        .footer-col a:hover {
            text-decoration: underline;
        }

        .redes-sociales {
            display: flex;
            gap: 14px;
            align-items: center;
            flex-wrap: wrap;
            margin-top: 12px;
        }

        .enlace-red-social {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: white;
            text-decoration: none;
            font-weight: 600;
            padding: 6px 10px;
            border-radius: 8px;
            transition: background-color 0.2s ease, transform 0.2s ease;
        }

        .enlace-red-social:hover {
            text-decoration: none;
            background-color: rgba(255, 255, 255, 0.08);
            transform: translateY(-2px);
        }

        .icono-red-social {
            width: 22px;
            height: 22px;
            flex-shrink: 0;
        }
    </style>
</head>

<body>

    <header>
        <div class="logo-container">
            <!-- Solo el logo lleva al inicio para que el t칤tulo no sea clickeable -->
            <a class="logo-link" href="/" aria-label="Volver al inicio">
                <img class="logo-img" src="images/LOGO.jpg" alt="Logo de la Escuela de Conductores J&J Palacios SPA">
            </a>
            <span class="logo-texto">ESCUELA DE CONDUCTORES J&J PALACIOS SPA</span>
        </div>
        <nav>
            <a href="/">Inicio</a>
            <a href="/cursos">Cursos</a>
            <a href="/contenidos">Contenido</a>
            <a href="/contacto">Contacto</a>
            <a href="/usuarios" class="enlace-admin" id="enlace-gestion-usuarios">Gesti칩n usuarios</a>
        </nav>
        <button class="btn-login" type="button" id="btn-iniciar-sesion">Iniciar sesi칩n</button>
        <button class="btn-login btn-cerrar-sesion oculto" type="button" id="btn-cerrar-sesion">Cerrar sesi칩n</button>
    </header>

    <section class="hero">
        <div class="hero-fondos" aria-hidden="true">
            <!-- Fondos locales para que el inicio cargue sin dependencias externas -->
            <div class="hero-fondo activo"
                style="background-image: linear-gradient(rgba(0, 0, 0, 0.25), rgba(0, 0, 0, 0.25)), url('images/dashboard1.jpeg');">
            </div>
            <div class="hero-fondo"
                style="background-image: linear-gradient(rgba(0, 0, 0, 0.25), rgba(0, 0, 0, 0.25)), url('images/dashboard2.jpeg');">
            </div>
            <!-- Coloca la imagen dashboard.jpeg dentro de la carpeta images para que cargue en producci칩n -->
            <div class="hero-fondo"
                style="background-image: linear-gradient(rgba(0, 0, 0, 0.25), rgba(0, 0, 0, 0.25)), url('images/dashboard3.jpeg');">
            </div>
        </div>
        <div class="hero-controles" aria-label="Seleccionar imagen de portada">
            <button class="control-hero activo" type="button" aria-label="Mostrar imagen uno"></button>
            <button class="control-hero" type="button" aria-label="Mostrar imagen dos"></button>
            <button class="control-hero" type="button" aria-label="Mostrar imagen tres"></button>
        </div>
    </section>

    <section class="section-container">
        <h2>QUI칄NES SOMOS</h2>
        <div class="about-box">
            <p>Somos una escuela de conducci칩n fundada el 27 de enero de 2024, ubicada en San Antonio 144, en la comuna
                de Litueche, con el firme prop칩sito de formar conductores responsables, seguros y conscientes de su rol
                en el tr치nsito. Nuestra instituci칩n fue creada por Jorge Palacios Vargas, instructor te칩rico certificado
                por el SEMEP, con vocaci칩n por la ense침anza y un fuerte compromiso con la educaci칩n vial.</p> 

            <p>La escuela se encuentra debidamente acreditada por el Ministerio de Transportes, cumpliendo con todas
                las exigencias legales y normativas vigentes, lo que garantiza a nuestros alumnos una formaci칩n seria,
                confiable y alineada con los est치ndares oficiales.</p> 

            <p>Nos especializamos en la ense침anza te칩rica y pr치ctica para la obtenci칩n de la Licencia de Conducir Clase
                B, entregando una preparaci칩n integral que combina conocimientos t칠cnicos, normativa de tr치nsito,
                educaci칩n vial y pr치ctica real de conducci칩n.</p> 
            
        </div>
        <h3 class="subtitulo-galeria">GALER칈A</h3>
        <div class="galeria-examenes">
            <!-- Se usan rutas relativas para que las im치genes funcionen tanto en local como al publicar el sitio -->
            <div class="tarjeta-imagen">
                <img src="images/ImagenExamenes.jpeg" alt="Imagen de ex치menes te칩ricos de conducci칩n">
            </div>
            <div class="tarjeta-imagen">
                <img src="images/FotoExamenes.jpeg" alt="Fotograf칤a de ex치menes pr치cticos en pista">
            </div>
            <div class="tarjeta-imagen">
                <img src="images/ExamenesPsico.jpeg" alt="Evaluaci칩n psicol칩gica para licencias de conducci칩n">
            </div>
            <div class="tarjeta-imagen">
                <img src="images/Examenes.jpeg" alt="Material de estudio para ex치menes de conducci칩n">
            </div>
        </div>
    </section>

    <div class="visor-imagen" aria-hidden="true">
        <div class="visor-caja" role="dialog" aria-modal="true" aria-label="Vista ampliada de la imagen de la galer칤a">
            <img src="" alt="">
            <button type="button" class="boton-cerrar" aria-label="Cerrar imagen ampliada">Cerrar</button>
        </div>
    </div>

    <footer>
        <div class="footer-grid">
            <div class="footer-col">
                <h3>Cont치ctanos</h3>
                <p>游늸 San Antonio, 144, Litueche</p>
                <p>游 +56 9 2755 4226</p>
                <p>九괦잺 jjpalaciosescuela@gmail.com</p>
            </div>
            <div class="footer-col">
                <h3>Horarios de Atenci칩n</h3>
                <p>Lunes a Viernes: 09:00 a 13:00, 14:00 a 18:00</p>
            </div>
            <div class="footer-col">
                <h3>S칤guenos</h3>
                <div class="redes-sociales">
                    <a class="enlace-red-social"
                        href="https://www.facebook.com/profile.php?id=61585570170056&locale=es_LA" target="_blank"
                        rel="noopener noreferrer">
                        <img class="icono-red-social"
                            src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/facebook.svg"
                            alt="Logo de Facebook">
                        <span>Facebook</span>
                    </a>
                    <a class="enlace-red-social" href="https://www.instagram.com/conductoresjjpalacios/" target="_blank"
                        rel="noopener noreferrer">
                        <img class="icono-red-social"
                            src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/instagram.svg"
                            alt="Logo de Instagram">
                        <span>Instagram</span>
                    </a>
                </div>
            </div>
        </div>
        <div
            style="text-align: center; margin-top: 40px; border-top: 1px solid #333; padding-top: 20px; font-size: 0.8rem;">
            춸 2024 Escuela de Conductores J&J Palacios SPA curso te칩rico y pr치ctico basado en el art칤culo 18 del Decreto 39 del Ministerio de transportes y telecomunicaciones.
        </div>
    </footer>
    <div class="capa-modal" id="capa-modal" aria-hidden="true">
        <div class="modal-acceso" role="dialog" aria-modal="true" aria-labelledby="titulo-modal-acceso">
            <button class="cerrar-modal" id="cerrar-modal" aria-label="Cerrar formulario de ingreso">칑</button>
            <div class="modal-logo">
                <img src="images/LOGO.jpg" alt="Logo de la escuela de conductores">
            </div>
            <div class="modal-encabezado">
                <div>
                    <h3 id="titulo-modal-acceso">Iniciar sesi칩n</h3>
                    <p>Utilice su correo y contrase침a para acceder.</p>
                </div>
                <span class="icono-info" aria-hidden="true">i</span>
            </div>
            <form id="formulario-acceso">
                <div class="grupo-campo">
                    <label for="campo-correo">Correo</label>
                    <div class="campo-input">
                        <input id="campo-correo" name="correo" type="email" placeholder="Ej. persona@dominio.cl"
                            autocomplete="email" inputmode="email">
                    </div>
                </div>
                <div class="grupo-campo">
                    <label for="campo-contrasena">Contrase침a</label>
                    <div class="campo-input">
                        <input id="campo-contrasena" name="contrasena" type="password"
                            placeholder="Igual que el nombre de usuario" autocomplete="current-password">
                        <button class="btn-ojo" type="button" id="toggle-contrasena"
                            aria-label="Mostrar u ocultar contrase침a">Ver</button>
                    </div>
                </div>
                <button class="btn-ingresar" type="submit">Ingresar</button>
                <p class="mensaje-error" id="mensaje-error" role="alert" aria-live="assertive"></p>
            </form>
        </div>
    </div>
    <script>
        // Animaci칩n simple para ir rotando las im치genes de fondo del hero
        document.addEventListener('DOMContentLoaded', () => {
            const enlaceGestionUsuarios = document.getElementById('enlace-gestion-usuarios');
            const btnIniciarSesion = document.getElementById('btn-iniciar-sesion');
            const btnCerrarSesion = document.getElementById('btn-cerrar-sesion');
            const capaModal = document.getElementById('capa-modal');
            const btnCerrarModal = document.getElementById('cerrar-modal');
            const botonToggleContrasena = document.getElementById('toggle-contrasena');
            const campoContrasena = document.getElementById('campo-contrasena');
            const formularioAcceso = document.getElementById('formulario-acceso');
            const mensajeError = document.getElementById('mensaje-error');
            const claveSesionAutenticada = 'usuario_autenticado';
            const claveDatosUsuario = 'usuario_datos';
            const claveSesionAdmin = 'usuario_admin';
            const correoAdmin = 'admin@gmail.com';
            const fondosHero = document.querySelectorAll('.hero-fondo');
            const controlesHero = document.querySelectorAll('.control-hero');
            let usuarioAutenticado = false;
            let usuarioAdmin = false;
            let datosUsuario = null;
            let indiceActual = 0;
            let intervaloHero = null;
            const tiempoCambioHero = 5000;

            // Mantiene la sesi칩n activa para que no se cierre al cambiar de pantalla.
            function guardarSesionUsuario(usuario, esAdmin) {
                sessionStorage.setItem(claveSesionAutenticada, 'true');
                sessionStorage.setItem(claveDatosUsuario, JSON.stringify(usuario || null));
                sessionStorage.setItem(claveSesionAdmin, esAdmin ? 'true' : 'false');
            }

            function cargarSesionUsuario() {
                const estadoSesion = sessionStorage.getItem(claveSesionAutenticada);
                if (estadoSesion === 'true') {
                    usuarioAutenticado = true;
                    try {
                        datosUsuario = JSON.parse(sessionStorage.getItem(claveDatosUsuario)) || null;
                    } catch (error) {
                        datosUsuario = null;
                    }
                }
                usuarioAdmin = sessionStorage.getItem(claveSesionAdmin) === 'true';
                actualizarBotonesSesion();
                actualizarVisibilidadGestionUsuarios();
            }

            function cerrarSesionUsuario() {
                usuarioAutenticado = false;
                usuarioAdmin = false;
                datosUsuario = null;
                sessionStorage.removeItem(claveSesionAutenticada);
                sessionStorage.removeItem(claveDatosUsuario);
                sessionStorage.removeItem(claveSesionAdmin);
                actualizarBotonesSesion();
                actualizarVisibilidadGestionUsuarios();
            }

            // Lee el correo guardado en la sesi칩n para mostrar el acceso solo al administrador.
            function obtenerCorreoSesion() {
                try {
                    if (datosUsuario && typeof datosUsuario.correo === 'string') {
                        return datosUsuario.correo.trim().toLowerCase();
                    }
                } catch (error) {
                    return '';
                }
                return '';
            }

            function actualizarVisibilidadGestionUsuarios() {
                if (!enlaceGestionUsuarios) {
                    return;
                }
                const correoSesion = obtenerCorreoSesion();
                const esAdmin = correoSesion === correoAdmin && usuarioAdmin;
                enlaceGestionUsuarios.classList.toggle('visible', esAdmin);
            }

            function actualizarBotonesSesion() {
                btnIniciarSesion.classList.toggle('oculto', usuarioAutenticado);
                btnCerrarSesion.classList.toggle('oculto', !usuarioAutenticado);
            }

            function actualizarEstadoScroll() {
                const modalVisible = capaModal.classList.contains('visible');
                document.body.classList.toggle('sin-scroll', modalVisible);
            }

            function mostrarModalAcceso() {
                if (usuarioAutenticado) {
                    return;
                }
                capaModal.classList.add('visible');
                capaModal.setAttribute('aria-hidden', 'false');
                document.getElementById('campo-correo').focus();
                actualizarEstadoScroll();
            }

            function ocultarModalAcceso() {
                capaModal.classList.remove('visible');
                capaModal.setAttribute('aria-hidden', 'true');
                mensajeError.classList.remove('visible');
                mensajeError.textContent = '';
                formularioAcceso.reset();
                actualizarEstadoScroll();
            }

            // Alterna la visibilidad de la contrase침a para que el usuario pueda verificarla.
            function alternarContrasena() {
                const esTexto = campoContrasena.type === 'text';
                campoContrasena.type = esTexto ? 'password' : 'text';
                botonToggleContrasena.textContent = esTexto ? 'Ver' : 'Ocultar';
            }

            // Controla el formulario de acceso con validaci칩n b치sica antes de consultar el backend.
            async function manejarIngreso(evento) {
                evento.preventDefault();
                const correo = document.getElementById('campo-correo').value.trim();
                const contrasena = campoContrasena.value.trim();

                if (!correo || !contrasena) {
                    mensajeError.textContent = 'Ingrese correo y contrase침a para continuar.';
                    mensajeError.classList.add('visible');
                    return;
                }

                try {
                    const respuesta = await autenticarUsuario(correo, contrasena);
                    usuarioAutenticado = true;
                    usuarioAdmin = correo.trim().toLowerCase() === correoAdmin && contrasena === 'admin';
                    datosUsuario = respuesta.usuario;
                    guardarSesionUsuario(respuesta.usuario, usuarioAdmin);
                    actualizarBotonesSesion();
                    actualizarVisibilidadGestionUsuarios();
                    ocultarModalAcceso();
                } catch (error) {
                    const mensaje = error?.message || 'No se pudo validar el acceso.';
                    mensajeError.textContent = mensaje;
                    mensajeError.classList.add('visible');
                }
            }

            // Env칤a las credenciales al backend propio para validar el acceso.
            async function autenticarUsuario(correo, contrasena) {
                const respuesta = await fetch('/api/autenticacion', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ correo, contrasena })
                });

                const datos = await respuesta.json().catch(() => ({}));

                if (!respuesta.ok || datos.exito === false) {
                    throw new Error(datos.mensaje || datos.error || 'Las credenciales no son v치lidas.');
                }

                if (!datos.usuario) {
                    throw new Error("Respuesta inv치lida del servidor: falta 'usuario'.");
                }

                return datos;
            }

            function mostrarFondoSeleccionado(indiceNuevo) {
                if (indiceNuevo === indiceActual) return;
                fondosHero[indiceActual].classList.remove('activo');
                controlesHero[indiceActual].classList.remove('activo');

                fondosHero[indiceNuevo].classList.add('activo');
                controlesHero[indiceNuevo].classList.add('activo');

                indiceActual = indiceNuevo;
            }

            // Reinicia el carrusel para que el usuario tenga tiempo de ver la imagen elegida.
            function reiniciarCambioAutomatico() {
                if (intervaloHero) {
                    clearInterval(intervaloHero);
                }
                intervaloHero = setInterval(() => {
                    const siguienteIndice = (indiceActual + 1) % fondosHero.length;
                    mostrarFondoSeleccionado(siguienteIndice);
                }, tiempoCambioHero);
            }

            controlesHero.forEach((control, indice) => {
                control.addEventListener('click', () => {
                    mostrarFondoSeleccionado(indice);
                    reiniciarCambioAutomatico();
                });
            });

            reiniciarCambioAutomatico();
            cargarSesionUsuario();
            btnIniciarSesion.addEventListener('click', mostrarModalAcceso);
            btnCerrarSesion.addEventListener('click', cerrarSesionUsuario);
            btnCerrarModal.addEventListener('click', ocultarModalAcceso);
            capaModal.addEventListener('click', (evento) => {
                if (evento.target === capaModal) {
                    ocultarModalAcceso();
                }
            });
            botonToggleContrasena.addEventListener('click', alternarContrasena);
            formularioAcceso.addEventListener('submit', manejarIngreso);
            // Visor para ampliar im치genes de la galer칤a con fondo sombreado
            const imagenesGaleria = document.querySelectorAll('.tarjeta-imagen img');
            const visorImagen = document.querySelector('.visor-imagen');
            const contenedorImagen = visorImagen.querySelector('img');
            const botonCerrar = visorImagen.querySelector('.boton-cerrar');
            const cuerpoDocumento = document.body;

            function abrirVisor(imagenSeleccionada) {
                contenedorImagen.src = imagenSeleccionada.src;
                contenedorImagen.alt = imagenSeleccionada.alt || 'Imagen ampliada de la galer칤a';
                visorImagen.classList.add('activo');
                visorImagen.setAttribute('aria-hidden', 'false');
                cuerpoDocumento.classList.add('sin-scroll');
            }

            function cerrarVisor() {
                visorImagen.classList.remove('activo');
                visorImagen.setAttribute('aria-hidden', 'true');
                contenedorImagen.removeAttribute('src');
                contenedorImagen.removeAttribute('alt');
                cuerpoDocumento.classList.remove('sin-scroll');
            }

            imagenesGaleria.forEach((imagen) => {
                imagen.setAttribute('tabindex', '0');
                imagen.addEventListener('click', () => abrirVisor(imagen));
                imagen.addEventListener('keydown', (evento) => {
                    if (evento.key === 'Enter' || evento.key === ' ') {
                        evento.preventDefault();
                        abrirVisor(imagen);
                    }
                });
            });

            visorImagen.addEventListener('click', (evento) => {
                if (evento.target === visorImagen) {
                    cerrarVisor();
                }
            });

            botonCerrar.addEventListener('click', () => {
                cerrarVisor();
            });

            document.addEventListener('keydown', (evento) => {
                if (evento.key === 'Escape' && visorImagen.classList.contains('activo')) {
                    cerrarVisor();
                }
            });
        });
    </script>
</body>

</html>
